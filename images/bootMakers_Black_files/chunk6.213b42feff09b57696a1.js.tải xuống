!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="//d36aba6isifr8u.cloudfront.net/",n(n.s=1078)}({1078:function(e,t,n){"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[652],{55652:function(e,t,n){n.r(t),n.d(t,{EditApplicationQuestions:function(){return V}});var r,o=n(4942),i=n(1413),a=n(29439),u=n(72791),l=n(58914),s=n(47470),c=n(67414),d=n(61134),p=n(33168),x=n(57689),f=n(92575),m=n(7385),v=n(85883),h=n(29381),y=n(69822),k=n(88794),g=n(91933),b=n(53954),j=n(37480),Z=n.n(j),T=function(e){return e.image="image",e.integer="integer",e.string="text",e}({}),S=(r={},(0,o.Z)(r,T.integer,"number"),(0,o.Z)(r,T.string,"text"),(0,o.Z)(r,T.image,"file"),r),q=n(37762),C=n(93433),_=n(68870),P=n(17133),Q=n(4567),w=n(65924),U=n(61094),L=n(25801),D=n(22523),E=n(62812),B=n(80184),O=function(e){var t=e.options,n=e.control,r=e.name,o=(0,d.bc)({control:n,name:r}).field,i=(0,u.useState)([]),l=(0,a.Z)(i,2),s=l[0],c=l[1],p=(0,u.useCallback)((function(e){return function(t){var n=(0,C.Z)(s);n[e]=t.target.checked?t.target.value:null,o.onChange(n),c(n)}}),[o,s]);return(0,u.useEffect)((function(){o&&o.value&&o.value.length&&c(o.value)}),[o]),(0,B.jsx)(D.Z,{sx:{marginLeft:"5px"},children:t.map((function(e,t){var n=e.displayLabel,r=e.markUpDisplayLabel,o=e.id,i=e.key;return(0,B.jsx)(L.ZP,{sx:{display:"flex"},control:(0,B.jsx)(U.Z,{onChange:p(t),checked:s.includes(n),value:n,sx:{alignSelf:"flex-start",maxHeight:"25px"}},o),label:(0,B.jsx)(E.Z,{sx:{fontSize:"14px",color:w.i.mvkBlack.textColor,paddingBottom:"7px"},component:"span",children:(0,B.jsx)("span",{dangerouslySetInnerHTML:{__html:r||n||""}})})},i)}))})},M=n(50228),H=n(58875),I=n(96746),z=n(69083),R=n(88970),A=n(4950),G=n(79593),F=function(e,t,n,r,o,s){var c=(0,u.useState)([]),p=(0,a.Z)(c,2),x=p[0],f=p[1];return(0,u.useEffect)((function(){if(e){!function(e){e.forEach((function(e){var t=e.markUpQuestionText;e.markUpQuestionText=Z()(t||""),e.dataPointDefinition&&e.dataPointDefinition.setElements&&e.dataPointDefinition.setElements.forEach((function(e){return(0,i.Z)((0,i.Z)({},e),{},{markUpDisplayLabel:Z()(e.markUpDisplayLabel||"")})}))}))}(e);var a=e.reduce((function(e,a){var u=a.dataPointDefinition,c=u.multi,p=u.setElements,x=u.type,f=u.id,m=u.key,v=a.required,h=a.questionText,y=a.markUpQuestionText,k=p.length;if(!c&&!k&&x!==T.image&&m&&x&&f){var g=function(e){var t=e.control,n=e.errors,r=e.id,o=e.key,a=e.register,u=e.required,l=e.requiredText,s=e.questionText,c=e.markUpQuestionText,p=e.type;return(0,B.jsx)(d.Qr,{control:t,name:o,render:function(e){var t=e.field;return(0,B.jsxs)(M.Z,{sx:{display:"inline-block",position:"relative",width:"100%",m:"16px 0px 8px 0px"},children:[(0,B.jsxs)(H.Z,{"data-testid":"input-label",sx:{paddingBottom:"7px",textOverflow:"initial",whiteSpace:"normal",color:w.i.mvkBlack.textColor,fontSize:"14px"},children:[(0,B.jsx)("span",{dangerouslySetInnerHTML:{__html:c||s||""}}),u&&(0,B.jsx)(E.Z,{component:"span",color:"red",children:"*"})]}),(0,B.jsx)(I.Z,(0,i.Z)((0,i.Z)({type:S[p],sx:function(e){var t=e.palette;return{width:"100%","& .Mui-error":{borderColor:t.mvkRed.required,outlineColor:t.mvkRed.required}}},"data-testid":"outlined-input-".concat(p)},a(o,{required:u})),{},{value:t.value,error:n[o]})),n[o]&&(0,B.jsx)(E.Z,{sx:function(e){return{fontSize:"14px",color:e.palette.mvkRed.required}},children:l})]})}},r)}({control:o,errors:t,id:f,key:m,register:r,required:v,requiredText:n,questionText:h,markUpQuestionText:y,type:x});e.push(g)}if(!c&&!k&&x===T.image&&m&&f){var b=function(e){var t=e.control,n=e.id,r=e.key,o=e.questionText,i=e.markUpQuestionText,a=e.required,u=e.setFormValue;return(0,B.jsx)(d.Qr,{control:t,name:r,render:function(e){var t=e.field;return(0,B.jsxs)(M.Z,{sx:{display:"block",width:"100%",m:"0px 2px 0px 2px",marginTop:"8px",marginBottom:"8px"},children:[(0,B.jsxs)(H.Z,{"data-testid":"input-label",sx:{color:w.i.mvkBlack.textColor,fontSize:"14px"},children:[(0,B.jsx)("span",{dangerouslySetInnerHTML:{__html:i||o||""}}),a&&(0,B.jsx)(E.Z,{component:"span",color:"red",children:"*"})]}),(0,B.jsx)(A.z,{nonDismissableResource:!0,acceptContentType:G.ev.files,initialResourceURL:{image:t.value},hasCaptionField:!1,setFormValue:u,setHasUploadedResource:void 0})]})}},n)}({control:o,id:f,key:m,questionText:h,markUpQuestionText:y,required:v,setFormValue:function(e){return s(m,[e])}});e.push(b)}if(!c&&k&&m&&f){var j=function(e){var t=e.control,n=e.id,r=e.key,o=e.questionText,a=e.markUpQuestionText,u=e.required,s=e.elements;return(0,B.jsxs)(_.Z,{children:[(0,B.jsxs)(P.ZP,{sx:{marginTop:"14px",color:w.i.mvkBlack.textColor,fontSize:"14px"},children:[(0,B.jsx)("span",{dangerouslySetInnerHTML:{__html:a||""}}),u&&(0,B.jsx)(Q.default,{component:"span",color:"red",children:"*"})]}),(0,B.jsx)(d.Qr,{control:t,name:r,render:function(e){var t=e.field;return(0,B.jsx)(R.Z,(0,i.Z)((0,i.Z)({sx:{marginLeft:"5px"}},t),{},{children:s.map((function(e){return(0,B.jsx)(L.ZP,{value:e.displayLabel,sx:{display:"flex"},control:(0,B.jsx)(z.Z,{icon:(0,B.jsx)(l.$Q,{height:"20px",width:"20px"}),checkedIcon:(0,B.jsx)(l.pE,{height:"20px",width:"20px"}),value:e.displayLabel,checked:t.value===e.displayLabel,sx:{alignSelf:"flex-start",maxHeight:"25px"}}),label:(0,B.jsx)(Q.default,{sx:{fontSize:"14px",color:w.i.mvkBlack.textColor,paddingBottom:"7px"},component:"span",children:(0,B.jsx)("span",{dangerouslySetInnerHTML:{__html:e.markUpDisplayLabel||o||""}})})},e.key)}))}))}})]},n)}({control:o,elements:p,id:f,key:m,questionText:h,markUpQuestionText:y,required:v});e.push(j)}if(c&&k&&m&&f){var Z=function(e){var t=e.control,n=e.elements,r=e.errors,o=e.id,i=e.key,a=e.questionText,u=e.markUpQuestionText,l=e.required,s=e.requiredText;return(0,B.jsxs)(_.Z,{children:[(0,B.jsxs)(P.ZP,{sx:{marginTop:"14px",color:w.i.mvkBlack.textColor,fontSize:"14px",paddingBottom:"7px"},children:[(0,B.jsx)("span",{dangerouslySetInnerHTML:{__html:u||a||""}}),l&&(0,B.jsx)(Q.default,{component:"span",color:"red",children:"*"})]}),(0,B.jsx)(O,{control:t,name:i,options:n}),r[i]&&(0,B.jsx)(Q.default,{sx:function(e){return{fontSize:"14px",color:e.palette.mvkRed.required}},children:s})]},o)}({control:o,elements:p,errors:t,id:f,key:m,questionText:h,markUpQuestionText:y,required:v,requiredText:n});e.push(Z)}return e}),[]);f(a)}}),[o,t,e,r,n,s]),x},V=function(){var e,t,n,r,j=(0,p.$)("Summary",{keyPrefix:"Other"}).t,Z=(0,p.$)("Summary",{keyPrefix:"ApplicationQuestionsSection"}).t,_=(0,u.useState)(null),P=(0,a.Z)(_,2),Q=P[0],w=P[1],U=(0,u.useState)(!0),L=(0,a.Z)(U,2),D=L[0],E=L[1],O=(0,u.useState)({}),M=(0,a.Z)(O,2),H=M[0],I=M[1],z=(0,x.UO)().campaignId,R=(k.Z.decodeAuthToken()||"").communityId,A=function(e,t){return(0,g.useQuery)([f.s3],(function(){return(0,b.hH)(e,t)}),{staleTime:3e5,keepPreviousData:!0,retry:!0})}(z,{communityId:R}).data,G=(0,h.s)(z).data,V=(0,y.Ly)().config,N=(0,d.cI)(),$=N.handleSubmit,J=N.register,W=N.control,K=N.reset,X=N.setValue,Y=N.watch,ee=(0,m.wp)("/campaigns/".concat(z,"/summary")),te=F(null==A||null===(e=A.survey)||void 0===e?void 0:e.questions,H,j("requiredText"),J,W,X),ne=(n={dataPoints:Q},r=!!Q,(0,g.useQuery)([f.GJ],(function(){return(0,b.u0)(n)}),{staleTime:3e5,keepPreviousData:!0,retry:!0,enabled:r})).data,re=(0,g.useMutation)((function(e){var t=e.params,n=e.campaignId;return(0,b._O)(n,t)}));(0,u.useEffect)((function(){if(ne){var e=function(e){var t={};return e.forEach((function(e){var n=e.value,r=e.dataPointDefinition,a=r.multi,u=r.key;a?(t[u]=t[u]?t[u]:[],t=(0,i.Z)((0,i.Z)({},t),{},(0,o.Z)({},u,[].concat((0,C.Z)(t[u]),[n])))):t=(0,i.Z)((0,i.Z)({},t),{},(0,o.Z)({},u,n))})),t}(ne);K(e)}}),[ne,K]),(0,u.useEffect)((function(){var e;if(A&&null!=A&&A.survey&&null!=A&&null!==(e=A.survey)&&void 0!==e&&e.questions){var t=A.survey.questions.map((function(e){return e.dataPointDefinition.id}));t.length&&w(t.join(","))}}),[A]);var oe=(0,u.useCallback)((function(e){if(!A||!A.survey||!A.survey.questions)return!1;var t=function(e,t){var n,r={},o=(0,q.Z)(e);try{for(o.s();!(n=o.n()).done;){var i,a=n.value,u=a.dataPointDefinition,l=u.type,s=u.key,c=u.multi,d=u.setElements,p=a.required,x=d.length;c||x?(!c&&x&&p&&!t[s]||c&&x&&p&&(null===(i=t[s])||void 0===i||!i.some((function(e){return!!e}))))&&(r[s]=!1):(S[l]!==S[T.image]&&p&&!t[s]||S[l]===S[T.image]&&p&&!t[s])&&(r[s]=!1)}}catch(e){o.e(e)}finally{o.f()}return r}(A.survey.questions,e);if(Object.keys(t).length){var n=Object.keys(t).map((function(e){return e})).reduce((function(e,t){return(0,i.Z)((0,i.Z)({},e),{},(0,o.Z)({},t,!0))}),{});return I(n),E(!1),!1}return I({}),E(!0),!0}),[A]),ie=(0,u.useCallback)((function(e){var t={};Object.keys(e).forEach((function(n){Array.isArray(e[n])?t[n]=e[n].filter((function(e){return null!==e})):t[n]=e[n]})),z&&oe(e)&&re.mutate({params:t,campaignId:z},{onSuccess:function(){v.E.invalidateQueries({predicate:function(e){var t=e.queryKey;return t[0]===f.s3||t[0]===f.GJ}}),ee()}})}),[z,ee,oe,re]);return(0,u.useEffect)((function(){var e=Y((function(e){return oe(e)}));return function(){return e.unsubscribe()}}),[oe,Y]),(0,B.jsxs)(c.default,{sx:function(e){var t=e.palette;return{maxWidth:"800px",mx:"auto",boxShadow:"0 4px 8px 0 ".concat(t.mvkGrey.shadow,", 0 6px 20px 0 ").concat(t.mvkGrey.shadow),backgroundColor:"white"}},"data-testid":"edit-application-questions",children:[(0,B.jsx)(l.jq,{color:"transparent",title:null!==(t=null==G?void 0:G.applicationTitle)&&void 0!==t?t:"",elevation:0,titleFontSize:20,imageSrc:V&&null!=V&&V.logoSmall?null==V?void 0:V.logoSmall:"",imageWidth:"40px",imageHeigth:"40px",sx:{backgroundColor:"white",position:"relative",textAlign:"center"},breadcrumbs:[(0,B.jsxs)(s.default,{onClick:ee,color:"inherit",sx:{fontSize:"14px"},children:["< "," ","campaignDetails"]},"2")]}),(0,B.jsx)(l.PO,{contentSx:{p:"0 30px 20px"},title:Z("detailsHeaderMessage"),backgroundColor:"mvkBlack.summarySectionHeader",textColor:"white",children:(0,B.jsxs)("form",{children:[(0,B.jsx)(c.default,{children:te}),(0,B.jsx)(l.UV,{variant:"community-primary",disabled:!D,onClick:$(ie),sx:{"&:disabled":{color:"white"},backgroundColor:null==V?void 0:V.styles.buttonColor,borderColor:null==V?void 0:V.styles.buttonColor,"&:hover":{backgroundColor:null==V?void 0:V.styles.buttonColorDark,borderColor:null==V?void 0:V.styles.buttonColorDark}},children:j("confirmButton")})]})})]})}},68870:function(e,t,n){var r=n(64836);t.Z=void 0;var o=n(98200),i=(r(n(52007)),n(1485)),a=(0,n(35424).createTheme)(),u=(0,o.createBox)({defaultTheme:a,defaultClassName:"MuiBox-root",generateClassName:i.unstable_ClassNameGenerator.generate});t.Z=u},1485:function(e,t,n){n.r(t),n.d(t,{unstable_ClassNameGenerator:function(){return r.Z}});var r=n(55902)}}])}});