if(!Suggest)var Suggest={};document.write("<script type='text/javascript' src='//api-275e520a5967c52e3c48e2d21be545c5.sui-sei.jp/suiseisuggest/suiseiCustomSuggestList.js'><\/script>"),document.write("<script type='text/javascript' src='//api-275e520a5967c52e3c48e2d21be545c5.sui-sei.jp/suiseisuggest/suiseiSuggestList.js'><\/script>"),document.write("<script type='text/javascript' src='//api-275e520a5967c52e3c48e2d21be545c5.sui-sei.jp/suiseisuggest/js.cookie.js'><\/script>"),Suggest.Key={TAB:9,RETURN:13,ESC:27,UP:38,DOWN:40},Suggest.getProtocol=function(){return document.location.protocol},Suggest.category1={},Suggest.category1_rie={},Suggest.category2={},Suggest.category2_rie={},Suggest.brand={},Suggest.ellipsis=function(text,cnt,optionalSize){for(var size,i,length,b=0,j=0,i=0,length=text.length;i<length;i++)if(text.charCodeAt(i)<=255?(b+=.5,j+=1):b+=1,b>cnt||j>optionalSize){text=text.substr(0,i)+"...";break}return text},Suggest.UserAgent={getDevice:function(){var userAgent=window.navigator.userAgent.toLowerCase(),device="pc";return(userAgent.indexOf("iphone")>0||userAgent.indexOf("ipad")>0||userAgent.indexOf("ipod")>0||userAgent.indexOf("android")>0)&&(device="mobile"),device}},Suggest.missingImg={replaceImg:function(imgTag){return imgTag.onerror="",imgTag.src="//"+document.domain+"/images/noimage/PC_NoImage.png",!0}},Suggest.RichSuggest={areaId:"suggest-dialog",url:"//api-275e520a5967c52e3c48e2d21be545c5.sui-sei.jp/rs/",pcItemNumber:6,mobileItemNumber:3,id:"item_id",title:"item_nm",price:"fixed_price",salePrice:"sale_price",category:"",brandName:"",colorName:"color_nm",newFlag:"new_flg",img:"item_img_url",link:"desc_url",hashCode:function(str){var hash=0,i,length;if(0==str.length)return hash;for(i=0,length=str.length;i<length;i++)char=str.charCodeAt(i),hash=(hash<<5)-hash+char,hash&=hash;return Math.abs(hash)},brandLink:function(items,key){var url="",word=items.word;return url="/item_list.html?siborikomi_clear=1&keyword={0}".replace("{0}",encodeURIComponent(word))},listBrandLink:function(candidate,key){var url="",word=candidate;return url="/item_list.html?siborikomi_clear=1&keyword={0}".replace("{0}",encodeURIComponent(word))},format:{price:function(price){return price=price.toString().replace(/^\d+[^\.]/,(function(t){return t.replace(/([\d]+?)(?=(?:\d{3})+$)/g,(function(t){return t+","}))}))},discountRate:function(discountRate){return" ( "+discountRate+" ％OFF)"},title:function(item){return item.name},description:function(description){return description=description.replace(/<.*>/g,"")},category:function(items){var category;return items.list[0][Suggest.RichSuggest.category]}},createItemArea:function(id,imgSrc,title,brandName,description,basicPrice,discountPrice,useSecretPriceFlg,discountRate,word,link,icons){var li=document.createElement("li");li.className="result-li",null!==id&&(li.id=id);var itemHref=document.createElement("a");itemHref.href=link;var imgDiv=document.createElement("div");imgDiv.className="img";var img=document.createElement("img");img.src=imgSrc,img.alt=title,img.title=title,img.onerror=Suggest.missingImg.replaceImg(this),imgDiv.appendChild(img),itemHref.appendChild(imgDiv);var infoDiv=document.createElement("div");infoDiv.className="info";var subDivBrand=document.createElement("div");subDivBrand.className="rs-brand",subDivBrand.textContent=brandName,subDivBrand.title=brandName,infoDiv.appendChild(subDivBrand);var subDivItem=document.createElement("div");if(subDivItem.className="rs-item",subDivItem.textContent=title,subDivItem.title=title,infoDiv.appendChild(subDivItem),""!==discountPrice){var subDivSalePrice=document.createElement("div");subDivSalePrice.className="rs-saleprice",subDivSalePrice.title=discountPrice,subDivSalePrice.textContent=discountPrice,infoDiv.appendChild(subDivSalePrice)}var subDivPrice=document.createElement("div");subDivPrice.className="rs-price",""!==discountPrice&&(subDivPrice.className+=" on-sale"),subDivPrice.title=basicPrice,subDivPrice.textContent=basicPrice,infoDiv.appendChild(subDivPrice),itemHref.appendChild(infoDiv),li.appendChild(itemHref);var iconsUl=document.createElement("ul");iconsUl.className="rs-icons-ul";for(var i=0;i<icons.length;i++){var iconLi=document.createElement("li");iconLi.className=icons[i]+" rs-icons",iconsUl.appendChild(iconLi)}return li.appendChild(iconsUl),li},link:function(item){return item.desc_url},img:function(item,key){var imgSrc;return void 0===key&&(key="item_img_url"),item[key]},imgOnlyItem:function(item,key){var imgSrc;return void 0===key&&(key="item_img_url"),item[key]}},Suggest.Tracking={baseUrl:"//api-275e520a5967c52e3c48e2d21be545c5.sui-sei.jp/",inputBoxFocusedUrl:"uo?type=input_focus&u={0}&lu={1}&page={2}&d=pc",richSuggestOpenedUrl:"uo?type=list_select&u={0}&lu={1}&page={2}&genre={3}&sword={4}&iword={5}&d=pc",itemDetailOpenedUrl:"uo?type=detail_view&u={0}&lu={1}&page={2}&genre={3}&sword={4}&iword={5}&i={6}&d=pc",listClickUrl:"uo?type=all_search&u={0}&lu={1}&page={2}&genre={3}&sword={4}&iword={5}&d=pc",sessionId:"undefined",userId:"undefined",scpId:"undefined",page:"undefined",brand:"undefined",createBaseUrl:function(url){return Suggest.getProtocol()+url},notify:function(callback,moveUrl){var url=callback();"undefined"!=typeof jQuery&&jQuery.ajax({type:"GET",url:url,crossDomain:!0,success:function(response){location.href=moveUrl},error:function(response){location.href=moveUrl}})},silentNotify:function(callback){var url=callback();"undefined"!=typeof jQuery&&jQuery.ajax({type:"GET",url:url,crossDomain:!0,success:function(response){},error:function(response){}})}},Suggest.copyProperties=function(dest,src){for(var property in src)dest[property]=src[property];return dest},Suggest.Local=function(){this.initialize.apply(this,arguments)},Suggest.Local.prototype={initialize:function(input,suggestArea,richSuggestArea,candidateList,customCandidateList){if(this.input=document.getElementsByClassName("headerSearch_input")[0],null!=this.input){this.suggestArea=this._getElement(suggestArea),this.suiseiArea=this._getElement(Suggest.RichSuggest.areaId),this.candidateList=candidateList,this.customCandidateList=customCandidateList,this.oldText=this.getInputText(),this.previousText=this.getInputText(),this.migemoTable=gen_migemo_table({katakana:!0}),arguments[5]&&this.setOptions(arguments[5]),this._addEvent(this.input,"focus",this._bind(this.inputFocus)),"pc"===Suggest.UserAgent.getDevice()&&(this._addEvent(this.input,"blur",this._bind(this.inputBlur)),this._addEvent(this.suggestArea,"blur",this._bind(this.inputBlur))),this.clearSuggestArea(),this.richSuggest={},this.richSuggestArea=this._getElement(richSuggestArea),this.clearRichSuggestArea(),this.jquery=null,"undefined"!=typeof jQuery&&(this.jquery=jQuery);try{this.inputSession();var sessionId=localStorage.getItem("suisei_uid")||"undefined";Suggest.Tracking.sessionId=sessionId}catch(e){Suggest.Tracking.sessionId="undefined"}}},inputSession:function(){var dataSuiseiUID;if(void 0===(dataSuiseiUID=localStorage.getItem("suisei_uid"))||null==dataSuiseiUID||""==dataSuiseiUID){var dataSuiseiUID=this.createSuiseiUid();localStorage.setItem("suisei_uid",dataSuiseiUID)}},createSuiseiUid:function(){var uuid="",i,random;for(i=0;i<32;i++)random=16*Math.random()|0,8!=i&&12!=i&&16!=i&&20!=i||(uuid+="-"),uuid+=(12==i?4:16==i?3&random|8:random).toString(16);return uuid},interval:500,dispMax:10,listTagName:"div",prefix:!1,ignoreCase:!0,highlight:!1,dispAllKey:!1,classMouseOver:"selected",classSelect:"selected",hookBeforeSearch:function(){},currentTarget:null,currentIndex:null,setOptions:function(options){Suggest.copyProperties(this,options)},inputBlur:function(){"mobile"!==Suggest.UserAgent.getDevice()&&setTimeout(this._bind((function(){document.activeElement!=this.suggestArea&&document.activeElement!=this.input&&(this.changeUnactive(),this.oldText=this.getInputText(),this.timerId&&clearTimeout(this.timerId),this.timerId=null,setTimeout(this._bind(this.clearSuggestArea),500),setTimeout(this._bind(this.clearRichSuggestArea),500))}),500))},inputBlurForMobile:function(){setTimeout(this._bind((function(){document.activeElement!=this.suggestArea&&document.activeElement!=this.input&&(this.changeUnactive(),this.oldText=this.getInputText(),this.timerId&&clearTimeout(this.timerId),this.timerId=null,setTimeout(this._bind(this.clearSuggestArea),10),setTimeout(this._bind(this.clearRichSuggestArea),10))}),10))},inputFocus:function(){var text=this.getInputText();this.oldText=text,this.inputBoxGetFocused(),null!=this.suggestArea&&""!=this.suggestArea.innerHTML||(""==text||null==text?this.showCustomList():this.search(text),this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(this._bind(this.checkLoop),this.interval))},checkLoop:function(){var text=this.getInputText();text!=this.oldText&&(this.oldText=text,""==text||null==text?(this.previousText=text,this.showCustomList()):this.search(text)),this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(this._bind(this.checkLoop),this.interval)},generateCustomList:function(){var resultList=[];this.suggestIndexList=[],this.suggestWordList=[];for(var candidateList=this.customCandidateList,i=0,length=candidateList.length;i<length;i++){var key=candidateList[i],duplicationFlag;if(!0!==this.checkExists(resultList,key)&&(resultList.push(key),this.suggestIndexList.push(i),this.suggestWordList.push(key),resultList.length>=10))break}return resultList},generateCustomRichSuggest:function(){null!=this.richSuggestArea&&(this.richSuggestArea.innerHTML="");var inner=document.createElement("div");inner.className="inner suisei-suggest-inner-custom";var rootDiv=document.createElement("div");rootDiv.className="contents",rootDiv.id="suisei-contents";var resultTop=document.createElement("div");resultTop.id="result_top";var resultTopText=document.createElement("h2"),topMessage="おすすめアイテム";resultTopText.textContent="おすすめアイテム",resultTop.appendChild(resultTopText),rootDiv.appendChild(resultTop);var ul=document.createElement("ul"),i,length;for(key in ul.className="result",this.customItemList){var id=this.customItemList[key][0],word=this.customItemList[key][1],title=this.customItemList[key][1],price=this.customItemList[key][3],description=null,imgSrc=this.customItemList[key][2],link=this.customItemList[key][5],icons=[],brandName=this.customItemList[key][4],li=Suggest.RichSuggest.createItemArea(id,imgSrc,title,brandName,null,price,word,link,icons),genre="おすすめアイテム",sword=word,iword=this.getInputText(),itemId=id;this._addEvent(li,"click",this._bindEvent(this.richSuggestItemClick,link,genre,sword,iword,itemId)),ul.appendChild(li)}rootDiv.appendChild(ul),inner.appendChild(rootDiv),this.richSuggestArea.appendChild(inner);var arrow=document.createElement("div");arrow.className="arrow",arrow.id="suisei-arrow",arrow.style="top: 30px;",this.richSuggestArea.appendChild(arrow);var richSuggestArea=this.richSuggestArea;this.richSuggestArea.scrollTop=0,this._addEvent(inner,"mouseover",this._bindEvent(this.richSuggestListMouseOver)),this._addEvent(inner,"mouseout",this._bindEvent(this.richSuggestListMouseOut))},showCustomList:function(){this.clearSuggestArea();var resultList=this.generateCustomList();if(0!=resultList.length){this.createCustomSuggestArea(resultList);var currentRichSuggestIndex=this.activePosition;null==this.activePosition&&(currentRichSuggestIndex=0),this.setStyleActive(this.suggestList[currentRichSuggestIndex]);var actives=this.suggestList[currentRichSuggestIndex].children,genre=actives[actives.length-1].getAttribute("data-suisei-category"),itemName=this.suggestWordList[currentRichSuggestIndex];this.requestRichSuggest(genre,itemName)}},search:function(){this.clearSuggestArea();var text=this.getInputText();this.hookBeforeSearch(text);var resultList=this._search(text);if(0!=resultList.length){this.createSuggestArea(resultList),this.previousText=text;var currentRichSuggestIndex=this.activePosition;null==this.activePosition&&(currentRichSuggestIndex=0),this.setStyleActive(this.suggestList[currentRichSuggestIndex]);var actives,genre=(actives=this.suggestList[currentRichSuggestIndex].children)[actives.length-1].getAttribute("data-suisei-category"),itemName=this.suggestWordList[currentRichSuggestIndex];this.requestRichSuggest(genre,itemName)}else if(this.clearSuggestArea(),""==this.previousText||null==this.previousText)this.showCustomList();else{resultList=this._search(this.previousText),this.createSuggestArea(resultList);var currentRichSuggestIndex=this.activePosition;if(null==this.activePosition&&(currentRichSuggestIndex=0),void 0===this.suggestList[currentRichSuggestIndex])this.showCustomList();else{this.setStyleActive(this.suggestList[currentRichSuggestIndex]);var actives,genre=(actives=this.suggestList[currentRichSuggestIndex].children)[actives.length-1].getAttribute("data-suisei-category"),itemName=this.suggestWordList[currentRichSuggestIndex];this.requestRichSuggest(genre,itemName)}}},_search:function(text){var resultList=[],migemoResultList=[],temp,temp2;this.suggestIndexList=[],this.suggestWordList=[];var itemLength={},candidateList={CATEGORY:[],ITEM:[]},words;for(var key in this.candidateList)for(var i=0,length=this.candidateList[key].length;i<length;i++)if(null!=(temp=this.isPartialMatch(this.candidateList[key][i],this._convertKey(text)))){var duplicationFlag;if(!0===this.checkExists(resultList,temp.v))continue;if(void 0===itemLength[key]&&(itemLength[key]=[]),itemLength[key].length>=this.dispMax)break;itemLength[key].push(temp.v);var result={},index;result[key]=temp,resultList.push(result),(index={})[key]=i,this.suggestIndexList.push(i),this.suggestWordList.push(temp.v),candidateList[key].push(temp)}for(var migemoText="",i=0,length=(words=-1!=text.indexOf(" ")?text.split(" "):[text]).length;i<length;i++)""!=migemoText&&(migemoText+=" "),migemoText+=migemo_str(words[i].toLowerCase(),this.migemoTable);var migemoIndex=migemoText.indexOf("("),i,length;for(var key in this.candidateList)for(var i=0,length=this.candidateList[key].length;i<length;i++)if(migemoIndex>=0)migemoResultList=[];else if(-1==migemoIndex){if(""===migemoText)continue;if(null!=(temp2=this.isPartialMatch(this.candidateList[key][i],this._convertKey(migemoText)))){var migemoDuplicationFlag=this.checkExists(resultList,temp2.v);if(!0===migemoDuplicationFlag)continue;if(!0===(migemoDuplicationFlag=this.checkExists(migemoResultList,temp2.v)))continue;if(void 0===itemLength[key]&&(itemLength[key]=[]),itemLength[key].length>=this.dispMax)break;itemLength[key].push(temp2.v);var result2={};result2[key]=temp2,migemoResultList.push(result2),this.suggestIndexList.push(i),this.suggestWordList.push(temp2.v),candidateList[key].push(temp2)}}for(i=0,length=migemoResultList.length;i<length;i++)resultList.push(migemoResultList[i]);for(var ret=[],index=0,indexList=[],wordList=[],shiftList=candidateList;Object.keys(shiftList).length>0&&ret.length<this.dispMax;)for(var k in shiftList){if(ret.length>=this.dispMax)break;if(void 0!==shiftList[k][0]){var target=shiftList[k].shift(),item={};item[k]=target,ret.push(item),indexList.push(index),wordList.push(target.v),index++}else delete shiftList[k]}return this.suggestIndexList=indexList,this.suggestWordList=wordList,ret},_convertKey:function(oldKey){var newKey;return oldKey.replace(/[ぁ-ん]/g,(function(s){return String.fromCharCode(s.charCodeAt(0)+96)}))},checkExists:function(list,word){var flag=!1;for(var k in list)for(var key in list[k])if(void 0!==list[k][key]&&list[k][key].v===word){flag=!0;break}return!0===flag},isPartialMatch:function(list,pattern){var value=list.v,key=list.k;if(null==key)return null;var pos=this.ignoreCase?key.toLowerCase().indexOf(pattern.toLowerCase()):key.indexOf(pattern),newList;return-1==pos||0!=pos?null:{k:key,v:list.v,r:list.r}},clearSuggestArea:function(){this.suggestArea.innerHTML="",this.suggestArea.style.display="none",this.suggestList=null,this.suggestIndexList=null,this.suggestWordList=null,this.activePosition=null,null!==this.suiseiArea&&(this.suiseiArea.style.display="none")},clearRichSuggestArea:function(){null!==this.richSuggestArea&&(this.richSuggestArea.innerHTML="",this.richSuggestArea.style.display="none")},listValue:function(list){return list.v},createCustomSuggestArea:function(resultList){this.suggestList=[],this.inputValueBackup=this.input.value;for(var key="おすすめキーワード",i=0,length=resultList.length;i<length;i++){var listValue=resultList[i],topElement=document.getElementById("suisei-suggest-custom-item-top-"+key),itemElement=document.createElement("li");itemElement.id=Suggest.RichSuggest.hashCode(listValue),itemElement.className="suisei-suggest-item-info";var rankingElement=document.createElement("div");if(itemElement.appendChild(rankingElement),null===topElement){var element=document.createElement("div");element.id="suisei-suggest-custom-item-top-"+key,element.className="suisei-suggest-custom-item-top",this.suggestArea.appendChild(element),topElement=element;var customTitleElement=document.createElement("div"),itemRootElement;customTitleElement.id="suisei-suggest-custom-item-title",customTitleElement.textContent=key,topElement.appendChild(customTitleElement),(itemRootElement=document.createElement("ul")).id="suisei-suggest-custom-item-sub-"+key;var keywordElement,text=listValue;(keywordElement=document.createElement("div")).className="suisei-suggest-item-info-keyword",keywordElement.textContent=text,keywordElement.title=text,keywordElement.setAttribute("data-suisei-category",key),itemElement.appendChild(keywordElement),itemRootElement.appendChild(itemElement),element.appendChild(itemRootElement)}else{var itemRootElement=document.getElementById("suisei-suggest-custom-item-sub-"+key),keywordElement,text=listValue;(keywordElement=document.createElement("div")).className="suisei-suggest-item-info-keyword",keywordElement.textContent=text,keywordElement.title=text,keywordElement.setAttribute("data-suisei-category",key),itemElement.appendChild(keywordElement),itemRootElement.appendChild(itemElement)}this._addEvent(keywordElement,"click",this._bindEvent(this.listClick,i)),this._addEvent(keywordElement,"mouseover",this._bindEvent(this.listMouseOver,i)),this._addEvent(keywordElement,"mouseout",this._bindEvent(this.listMouseOut,i)),this.suggestList.push(itemElement)}if("mobile"===Suggest.UserAgent.getDevice()){var close=document.createElement("div");close.className="close",close.textContent="閉じる",this.suggestArea.appendChild(close),this._addEvent(close,"click",this._bindEvent(this.inputBlurForMobile))}this.suggestArea.style.display="",this.suggestArea.scrollTop=0,null!==this.suiseiArea&&(this.suiseiArea.style.display="")},categoryNameChange:function(category){var changedCategoryName=null;return changedCategoryName="カテゴリ"===category?"CATEGORY":"ブランド"===category?"BRAND":"アイテム"===category?"ITEM":"MOOK番号"===category?"カタログ番号":category},createSuggestArea:function(resultList){this.suggestList=[],this.inputValueBackup=this.input.value;for(var i=0,length=resultList.length;i<length;i++)for(var key in resultList[i]){var listValue=this.listValue(resultList[i][key]),topElement=document.getElementById("suisei-suggest-item-top-"+key),itemElement=document.createElement("li");if(itemElement.id=Suggest.RichSuggest.hashCode(listValue),itemElement.className="suisei-suggest-item-info",null===topElement){var element=document.createElement("div"),itemRootElement;element.id="suisei-suggest-item-top-"+key,element.className="suisei-suggest-item-top",this.suggestArea.appendChild(element),topElement=element,(itemRootElement=document.createElement("ul")).id="suisei-suggest-item-sub-"+key;var categoryElement=document.createElement("div");categoryElement.className="suisei-suggest-item-info-category",categoryElement.textContent=this.categoryNameChange(key),itemElement.appendChild(categoryElement),categorySetFlag=!0;var keywordElement,text=listValue;(keywordElement=document.createElement("div")).className="suisei-suggest-item-info-keyword",keywordElement.textContent=text,keywordElement.title=text,keywordElement.setAttribute("data-suisei-category",key),itemElement.appendChild(keywordElement),itemRootElement.appendChild(itemElement),element.appendChild(itemRootElement)}else{var itemRootElement=document.getElementById("suisei-suggest-item-sub-"+key),keywordElement,text=listValue;(keywordElement=document.createElement("div")).className="suisei-suggest-item-info-keyword",keywordElement.textContent=text,keywordElement.title=text,keywordElement.setAttribute("data-suisei-category",key),itemElement.appendChild(keywordElement),itemRootElement.appendChild(itemElement)}this._addEvent(keywordElement,"click",this._bindEvent(this.listClick,i)),this._addEvent(keywordElement,"mouseover",this._bindEvent(this.listMouseOver,i)),this._addEvent(keywordElement,"mouseout",this._bindEvent(this.listMouseOut,i)),this.suggestList.push(itemElement)}if("mobile"===Suggest.UserAgent.getDevice()){var close=document.createElement("div");close.className="close",close.textContent="閉じる",this.suggestArea.appendChild(close),this._addEvent(close,"click",this._bindEvent(this.inputBlurForMobile))}this.suggestArea.style.display="",this.suggestArea.scrollTop=0,null!==this.suiseiArea&&(this.suiseiArea.style.display="")},requestRichSuggest:function(genre,itemName){var self=this;if(itemName in this.richSuggest)return this.clearRichSuggestArea(),this.createRichSuggestArea(this.richSuggest[itemName]);if(null===this.jquery);else{if("カテゴリ"===genre&&itemName in Suggest.category1)var category1=itemName,url=Suggest.getProtocol()+Suggest.RichSuggest.url+encodeURIComponent(category1);else var url=Suggest.getProtocol()+Suggest.RichSuggest.url+encodeURIComponent(itemName);"mobile"===Suggest.UserAgent.getDevice()?url+="?num="+Suggest.RichSuggest.mobileItemNumber:url+="?num="+Suggest.RichSuggest.pcItemNumber;var sword=itemName,iword=this.getInputText();this.richSuggestCreated(genre,sword,iword),this.jquery.ajax({type:"GET",url:url,dataType:"jsonp",crossDomain:!0,success:function(response){self.clearRichSuggestArea(),self.receiveRichSuggestResponse(response)}})}},onChangeRichSuggestItem:function(event,i){var self=this,element=this._getEventElement(event),ul=element.parentNode,rootDiv=ul.parentNode,word=ul.getAttribute("data-suisei-word"),more=document.getElementById("suisei-more"),callback=function(item){var ul=Suggest.Recommend.createRecommendArea(item,(function(href){self._addEvent(href,"click",self._bindEvent(self.clickForNotify))}));if(null!==more)try{rootDiv.removeChild(more)}catch(e){}rootDiv.appendChild(ul)};if("undefined"!=typeof jQuery){var url=Suggest.Recommend.createUrl(null,element.id);url in Suggest.Recommend.recommendItem?callback(Suggest.Recommend.recommendItem[url]):jQuery.ajax({type:"GET",url:url,dataType:"jsonp",crossDomain:!0,success:function(response){var item=Suggest.Recommend.parseResponse(response);item.length>0&&(Suggest.Recommend.recommendItem[url]=item,callback(item))}})}},receiveRichSuggestResponse:function(response){void 0!==response.word&&null!==response.word&&""!==response.word&&response.list.length>0&&(this.richSuggest[response.word]=response,this.createRichSuggestArea(response))},createRichSuggestArea:function(richSuggestList){var self=this,word=richSuggestList.word,list=richSuggestList.list,count=richSuggestList.count||0,inner=document.createElement("div");inner.className="inner suisei-suggest-inner";var hashCode=Suggest.RichSuggest.hashCode(word),suggestElement=this.currentTarget,suggestElementLi;if(null===suggestElement){var suggestElements=jQuery(".selected"),suggestElementLi;if(suggestElements.length>0)suggestElement=(suggestElementLi=suggestElements[0]).children[suggestElementLi.children.length-1]}null===suggestElement&&(suggestElement=(suggestElementLi=document.getElementById(hashCode)).children[suggestElementLi.children.length-1]);var category=suggestElement.getAttribute("data-suisei-category"),rootDiv=document.createElement("div");rootDiv.className="contents",rootDiv.id="suisei-contents";var resultTop=document.createElement("div");resultTop.id="result_top";var resultTopText=document.createElement("h2"),topMessage=word;resultTopText.textContent=topMessage,resultTop.appendChild(resultTopText),rootDiv.appendChild(resultTop);var ul=document.createElement("ul"),i,length;ul.className="result";for(var i=0,length=list.length;i<length;i++){var item=list[i],id=null;Suggest.RichSuggest.id in item&&(id=item[Suggest.RichSuggest.id]);var title=null;Suggest.RichSuggest.title in item&&(title=item[Suggest.RichSuggest.title]);var colorName=null;Suggest.RichSuggest.colorName in item&&(colorName=item[Suggest.RichSuggest.colorName]),null!==colorName&&"NONE"!==colorName&&(title=title+"（"+colorName+"）");var basicPrice=Suggest.RichSuggest.format.price(item[Suggest.RichSuggest.price]),discountPrice=Suggest.RichSuggest.format.price(item[Suggest.RichSuggest.salePrice]),useSecretPriceFlg=!1,discountRate=null;Suggest.RichSuggest.discountRate in item&&Number(item[Suggest.RichSuggest.discountRate])>0&&(discountRate=item[Suggest.RichSuggest.discountRate],"discountRate"in Suggest.RichSuggest.format&&(discountRate=Suggest.RichSuggest.format.discountRate(discountRate)));var description=null;Suggest.RichSuggest.description in item&&(description=item[Suggest.RichSuggest.description],"description"in Suggest.RichSuggest.format&&(description=Suggest.RichSuggest.format.description(description)));var imgSrc=null;"img"in Suggest.RichSuggest&&(imgSrc=Suggest.RichSuggest.img(item));var imgSrcOnlyItem=null;"img"in Suggest.RichSuggest&&(imgSrcOnlyItem=Suggest.RichSuggest.imgOnlyItem(item));var link=Suggest.RichSuggest.link(item),icons=[];Suggest.RichSuggest.newFlag in item&&"1"===item[Suggest.RichSuggest.newFlag]&&icons.push("new-icon"),Suggest.RichSuggest.orderFlg in item&&"1"===item[Suggest.RichSuggest.orderFlg]&&icons.push("order-icon"),Suggest.RichSuggest.couponFlg in item&&"1"===item[Suggest.RichSuggest.couponFlg]&&icons.push("coupon-icon"),Suggest.RichSuggest.reserveFlg in item&&"1"===item[Suggest.RichSuggest.reserveFlg]&&icons.push("reserve-icon");var brandName=null;Suggest.RichSuggest.brandName in item&&(brandName=item[Suggest.RichSuggest.brandName]);var li=Suggest.RichSuggest.createItemArea(id,imgSrc,title,brandName,description,basicPrice,discountPrice,!1,discountRate,word,link,icons),genre=category,sword=word,iword=this.getInputText(),itemId=id;this._addEvent(li,"click",this._bindEvent(this.richSuggestItemClick,link,genre,sword,iword,itemId)),ul.appendChild(li)}rootDiv.appendChild(ul),inner.appendChild(rootDiv),this.richSuggestArea.appendChild(inner);var viewAllDiv=document.createElement("div");viewAllDiv.id="result_bottom";var viewAllHref=document.createElement("a"),viewAllText="一覧で見る";viewAllHref.title="一覧で見る";var url=Suggest.RichSuggest.brandLink(richSuggestList,category);this._addEvent(viewAllHref,"click",this._bindEvent(this.viewAllClick,url,category,word)),viewAllDiv.appendChild(viewAllHref),rootDiv.appendChild(viewAllDiv);var richSuggestArea=this.richSuggestArea;this.richSuggestArea.scrollTop=0;var dialog=$("#suggest-dialog"),defPosition=$("#contents-inner").hasClass("top")?331:183,itemTop;try{itemTop=jQuery(".suggest-items li#"+hashCode+".selected").offset().top}catch(e){}var diff=jQuery(".suggest-items").offset().top+jQuery(".suggest-items").height()-(itemTop-jQuery(".suggest-items li#"+hashCode+".selected").height()),arrow=dialog.find(".arrow");if(dialog.height()<diff){var top=itemTop-defPosition+"px";0===this.currentIndex&&(top="0px"),dialog.css({display:"block",top:top,bottom:"auto"}),dialogTop=dialog.offset().top,arrow.css({top:"30px"})}else{var top="auto";1!==this.suggestList.length&&0!==this.currentIndex||(top="0px"),dialog.css({display:"block",top:top,bottom:0}),dialogTop=dialog.offset().top,arrow.css({top:itemTop-dialogTop+5+"px"})}this._addEvent(inner,"mouseover",this._bindEvent(this.richSuggestListMouseOver)),this._addEvent(inner,"mouseout",this._bindEvent(this.richSuggestListMouseOut)),void 0!==Suggest.Recommend&&Suggest.Recommend.requestRecommend(richSuggestList,(function(item){if(null!==item||item.length>0){var ul=Suggest.Recommend.createRecommendArea(item,(function(href){self._addEvent(href,"click",self._bindEvent(self.clickForNotify))}));rootDiv.appendChild(ul)}}))},getInputText:function(){var textAfter=this.input.value.substr(this.input.value.length-1);return" "==textAfter||"　"==textAfter?this.input.value.substring(0,this.input.value.length-1):this.input.value},setInputText:function(text){this.input.value=text},keyEvent:function(event){if(this.timerId||(this.timerId=setTimeout(this._bind(this.checkLoop),this.interval)),this.dispAllKey&&event.ctrlKey&&""==this.getInputText()&&!this.suggestList&&event.keyCode==Suggest.Key.DOWN)this._stopEvent(event),this.keyEventDispAll();else if(event.keyCode==Suggest.Key.UP||event.keyCode==Suggest.Key.DOWN){if("mobile"===Suggest.UserAgent.getDevice())return;this.suggestList&&0!=this.suggestList.length&&(this._stopEvent(event),this.keyEventMove(event.keyCode))}else event.keyCode==Suggest.Key.RETURN?this.suggestList&&0!=this.suggestList.length&&(this._stopEvent(event),this.keyEventReturn()):event.keyCode==Suggest.Key.ESC?this.suggestList&&0!=this.suggestList.length&&(this._stopEvent(event),this.keyEventEsc()):this.keyEventOther(event)},keyEventDispAll:function(){this.clearSuggestArea(),this.oldText=this.getInputText(),this.suggestIndexList=[],this.suggestWordList=[];for(var i=0,length=this.candidateList.length;i<length;i++)this.suggestIndexList.push(i),this.suggestWordList.push(this.candidateList[i].v);this.createSuggestArea(this.candidateList)},keyEventMove:function(keyCode){if(this.changeUnactive(),keyCode==Suggest.Key.UP){if(null==this.activePosition)this.activePosition=this.suggestList.length-1;else if(this.activePosition--,this.activePosition<0)return this.activePosition=null,this.input.value=this.inputValueBackup,void(this.suggestArea.scrollTop=0)}else if(null==this.activePosition?this.activePosition=0:this.activePosition++,this.activePosition>=this.suggestList.length)return this.activePosition=null,this.input.value=this.inputValueBackup,void(this.suggestArea.scrollTop=0);this.changeActive(this.activePosition)},keyEventReturn:function(){this.clearSuggestArea(),this.moveEnd();var itemName=this.getInputText(),link=Suggest.RichSuggest.viewAll.link({word:itemName});window.location.href=link},keyEventEsc:function(){this.clearSuggestArea(),this.input.value=this.inputValueBackup,this.oldText=this.getInputText(),window.opera&&setTimeout(this._bind(this.moveEnd),5)},keyEventOther:function(event){},changeActive:function(index){this.currentIndex=index,this.setStyleActive(this.suggestList[index]);var actives=this.suggestList[index].children,genre=actives[actives.length-1].getAttribute("data-suisei-category");this.setInputText(this.suggestWordList[index]);var itemName=this.suggestWordList[index];this.requestRichSuggest(genre,itemName),this.oldText=this.getInputText(),this.input.focus()},changeUnactive:function(){null!=this.suggestList&&this.suggestList.length>0&&null!=this.activePosition&&this.setStyleUnactive(this.suggestList[this.activePosition])},closeAccordion:function(event){var element,parent,children=this._getEventElement(event).parentNode.childNodes,i,length;for(i=0,length=children.length;i<length;i++){var node=children[i].childNodes[0],className=node.className;""!==className&&("over"===className&&children[i].removeChild(node.nextElementSibling))}},closeClick:function(event,index){this.clearSuggestArea()},viewAllClick:function(event,link,category,word){var genre=category,sword=word,iword=this.getInputText();this.richSuggestSearchAllClick(link,genre,sword,iword)},listClick:function(event,index){var element,tagName=this._getEventElement(event).tagName.toLowerCase();if("a"===tagName||"img"===tagName||"li"===tagName||"div"===tagName){var itemName=this.suggestWordList[index],key=event.target.attributes.getNamedItem("data-suisei-category").value,link=Suggest.RichSuggest.listBrandLink(itemName,key),genre=key,sword=itemName,iword=this.getInputText();this.richSuggestSearchAllClick(link,genre,sword,iword)}},listMouseOver:function(event,index){var self=this,element=this._getEventElement(event);"pc"===Suggest.UserAgent.getDevice()&&this.setStyleMouseOver(element);var itemName=this.suggestWordList[index];this.currentTarget=element,this.currentIndex=index;var actives=this.suggestList[index].children,genre=actives[actives.length-1].getAttribute("data-suisei-category");this.requestRichSuggest(genre,itemName)},richSuggestListMouseOver:function(event){var currentWord=event.currentTarget.getAttribute("data-suisei-word");if(null!=currentWord){var element=document.getElementById("suisei-"+currentWord);this.setStyleActive(element)}},richSuggestListMouseOut:function(event){var currentWord=event.currentTarget.getAttribute("data-suisei-word");if(null!=currentWord){var element=document.getElementById("suisei-"+currentWord);this.setStyleUnactive(element)}},inputBoxGetFocused:function(){void 0!==Suggest.Tracking&&Suggest.Tracking.silentNotify((function(){var baseUrl=Suggest.Tracking.createBaseUrl(Suggest.Tracking.baseUrl),url=Suggest.Tracking.inputBoxFocusedUrl;return url=baseUrl+(url=(url=(url=url.replace("{0}",Suggest.Tracking.sessionId)).replace("{1}",Suggest.Tracking.userId)).replace("{2}",Suggest.Tracking.page))}))},richSuggestCreated:function(genre,sword,iword){void 0!==Suggest.Tracking&&Suggest.Tracking.silentNotify((function(){var baseUrl=Suggest.Tracking.createBaseUrl(Suggest.Tracking.baseUrl),url=Suggest.Tracking.richSuggestOpenedUrl;return url=baseUrl+(url=(url=(url=(url=(url=(url=url.replace("{0}",Suggest.Tracking.sessionId)).replace("{1}",Suggest.Tracking.userId)).replace("{2}",Suggest.Tracking.page)).replace("{3}",encodeURIComponent(genre))).replace("{4}",encodeURIComponent(sword))).replace("{5}",encodeURIComponent(iword)))}))},richSuggestItemClick:function(event,moveUrl,genre,sword,iword,itemId){void 0!==Suggest.Tracking&&Suggest.Tracking.notify((function(){var baseUrl=Suggest.Tracking.createBaseUrl(Suggest.Tracking.baseUrl),url=Suggest.Tracking.itemDetailOpenedUrl;return url=baseUrl+(url=(url=(url=(url=(url=(url=(url=url.replace("{0}",Suggest.Tracking.sessionId)).replace("{1}",Suggest.Tracking.userId)).replace("{2}",Suggest.Tracking.page)).replace("{3}",encodeURIComponent(genre))).replace("{4}",encodeURIComponent(sword))).replace("{5}",encodeURIComponent(iword))).replace("{6}",encodeURIComponent(itemId)))}),moveUrl)},richSuggestSearchAllClick:function(moveUrl,genre,sword,iword){void 0!==Suggest.Tracking&&Suggest.Tracking.notify((function(){var baseUrl=Suggest.Tracking.createBaseUrl(Suggest.Tracking.baseUrl),url=Suggest.Tracking.listClickUrl;return url=baseUrl+(url=(url=(url=(url=(url=(url=url.replace("{0}",Suggest.Tracking.sessionId)).replace("{1}",Suggest.Tracking.userId)).replace("{2}",Suggest.Tracking.page)).replace("{3}",encodeURIComponent(genre))).replace("{4}",encodeURIComponent(sword))).replace("{5}",encodeURIComponent(iword)))}),moveUrl)},listMouseOut:function(event,index){if(this.suggestList){var element=this._getEventElement(event);this.currentTarget=null,this.currentIndex=null,index==this.activePosition?this.setStyleActive(element):"pc"===Suggest.UserAgent.getDevice()&&this.setStyleUnactive(element)}},clickForNotify:function(event){var element=event.currentTarget,itemId=element.getAttribute("data-suise-item-id"),rqid=element.getAttribute("data-suise-rqid"),url=Suggest.Recommend.createNotifyUrl(itemId,rqid);"undefined"!=typeof jQuery&&jQuery.ajax({type:"GET",url:url,crossDomain:!0,success:function(response){}})},clickForRichsuggestListNotify:function(event){var element,itemId=event.currentTarget.getAttribute("data-suise-item-id")},clickForRichsuggestOpenedNotify:function(event){var element,itemId=event.currentTarget.getAttribute("data-suise-item-id")},clickForRichsuggestItemDetailNotify:function(event){var element,itemId=event.currentTarget.getAttribute("data-suise-item-id")},setStyleActive:function(element){"pc"===Suggest.UserAgent.getDevice()&&(element.className=element.className+" "+this.classSelect);var offset=element.offsetTop,offsetWithHeight=offset+element.clientHeight;this.suggestArea.scrollTop>offset?this.suggestArea.scrollTop=offset:this.suggestArea.scrollTop+this.suggestArea.clientHeight<offsetWithHeight&&(this.suggestArea.scrollTop=offsetWithHeight-this.suggestArea.clientHeight)},setStyleUnactive:function(element){var activeClassname=element.className;element.className=activeClassname.slice(0,-(this.classMouseOver.length+1))},setStyleMouseOver:function(element){var unactiveClassname=element.className;element.className=unactiveClassname+" "+this.classMouseOver},moveEnd:function(){if(this.input.createTextRange){this.input.focus();var range=this.input.createTextRange();range.move("character",this.input.value.length),range.select()}else this.input.setSelectionRange&&this.input.setSelectionRange(this.input.value.length,this.input.value.length)},_getElement:function(element){return"string"==typeof element?document.getElementById(element):element},_addEvent:window.addEventListener?function(element,type,func){element.addEventListener(type,func,!1)}:function(element,type,func){element.attachEvent("on"+type,func)},_stopEvent:function(event){event.preventDefault?(event.preventDefault(),event.stopPropagation()):(event.returnValue=!1,event.cancelBubble=!0)},_getEventElement:function(event){return event.target||event.srcElement},_bind:function(func){var self=this,args=Array.prototype.slice.call(arguments,1);return function(){func.apply(self,args)}},_bindEvent:function(func){var self=this,args=Array.prototype.slice.call(arguments,1);return function(event){event=event||window.event,func.apply(self,[event].concat(args))}},_escapeHTML:function(value){return value.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;")}};var gen_migemo_table=function(chartype){chartype=chartype||{hiragana:!0,katakana:!0};var initial_table={},hira2kata_array=function(hira){for(var kata=[],i=0,l=hira.length;i<l;i++)kata.push(String.fromCharCode(hira[i].charCodeAt(0)+96));return kata},hira2kata_str=function(hira){return hira2kata_array(hira.split("")).join("")};function hira2chars(hira){var result=[];return chartype.hiragana&&result.push(hira),chartype.katakana&&result.push(hira2kata_str(hira)),result}function hira2table(hira,table){return[hira2chars(hira),table]}var small_y_table={a:hira2table("ゃ",null),u:hira2table("ゅ",null),o:hira2table("ょ",null)};function register_row(si,hira){if(si.length>1)throw"error";for(var table={},i=0;i<5;i++)table[bo[i]]=hira2table(hira.charAt(i),initial_table);table[si]=hira2table("っ",table),table.y=hira2table(hira.charAt(1),small_y_table),initial_table[si]=[null,table]}function register_str(str,hira){for(var t=initial_table,i=0,l=str.length;i<l-1;i++){var c=str.charAt(i);t[c]||(t[c]=[null,{}]),t=t[c][1]}t[str.charAt(str.length-1)]=hira2table(hira,null)}for(var bo="aiueo".split(""),hira_bo="あいうえお".split(""),i=0,l=bo.length;i<l;i++)initial_table[bo[i]]=hira2table(hira_bo[i],initial_table);return register_row("x","ぁぃぅぇぉ"),register_row("l","ぁぃぅぇぉ"),register_row("k","かきくけこ"),register_row("s","さしすせそ"),register_row("t","たちつてと"),register_row("n","なにぬねの"),register_row("h","はひふへほ"),register_row("m","まみむめも"),register_row("r","らりるれろ"),register_row("g","がぎぐげご"),register_row("z","ざじずぜぞ"),register_row("d","だぢづでど"),register_row("b","ばびぶべぼ"),register_row("p","ぱぴぷぺぽ"),register_str("ja","じゃ"),register_str("ji","じ"),register_str("ju","じゅ"),register_str("je","じぇ"),register_str("jo","じょ"),register_str("wa","わ"),register_str("wo","を"),register_str("nn","ん"),register_str("ya","や"),register_str("yu","ゆ"),register_str("yo","よ"),register_str("xya","ゃ"),register_str("xyu","ゅ"),register_str("xyo","ょ"),register_str("lya","ゃ"),register_str("lyu","ゅ"),register_str("lyo","ょ"),register_str("xtu","っ"),register_str("ltu","っ"),register_str("sha","しゃ"),register_str("shi","し"),register_str("shu","しゅ"),register_str("she","しぇ"),register_str("sho","しょ"),register_str("cha","ちゃ"),register_str("chu","ちゅ"),register_str("cho","ちょ"),register_str("chi","ち"),register_str("fa","ふぁ"),register_str("fi","ふぃ"),register_str("fu","ふ"),register_str("fe","ふぇ"),register_str("fo","ふぉ"),register_str("si","し"),register_str("tsu","つ"),initial_table["-"]=["ー",null],initial_table.n[1].onMissing=function(c){return{row:initial_table[c],chars:hira2chars("ん")}},initial_table},migemo_str=function(input,initial_table){function gen_regex(chars){return chars&&0!=chars.length?"string"==typeof chars?chars:1==chars.length?chars[0]:"("+chars.join("|")+")":""}input=input||"";for(var table=initial_table=initial_table||gen_migemo_table(),result="",i=0,l=input.length;i<l;i++){var c=input.charAt(i),row=table[c],ret;if(!row&&table.onMissing&&(mis=table.onMissing(c),row=mis.row,result+=gen_regex(mis.chars)),row)""!==gen_regex(row[0])&&(result+=gen_regex(row[0])),(table=row[1])||(table=initial_table);else table=[],result=input}if(table!==initial_table){var candidates=[];function find_candidates(table){function from_row(row){return row?row[0]&&row[0].length>0?row[0]:row[1]?find_candidates(row[1]):[]:[]}var candidates=[];for(var x in table)table.hasOwnProperty(x)&&"onMissing"!=x&&Array.prototype.push.apply(candidates,from_row(table[x]));return candidates}function uniq(array){function indexOf(array,item){for(var i=0,l=array.length;i<l;i++)if(array[i]==item)return i;return-1}for(var result=[],i=0,l=array.length;i<l;i++)-1==indexOf(result,array[i])&&result.push(array[i]);return result}table.onMissing&&(next=table.onMissing(null),next[1]&&Array.prototype.push.apply(candidates,next[1])),Array.prototype.push.apply(candidates,find_candidates(table)),result+=gen_regex(uniq(candidates).sort())}return result},KDL_SUISEI=KDL_SUISEI||{},sortJsonBy=function(field,reverse,primer){return reverse=reverse?-1:1,function(a,b){return a=a[field],b=b[field],void 0!==primer&&(a=primer(a),b=primer(b)),a<b?-1*reverse:a>b?1*reverse:0}},start=function(){var s=new Suggest.Local("suggest-input","suggest-items","suggest-dialog",suiseiSuggestList,suiseiCustomSuggestList,{dispMax:10,highlight:!0,prefix:!0})};$(document).ready((function(){$("div.headerSearch").append('<div id="suggest" style="display: block;"><div class="dialog" id="suggest-dialog" style="display: none;"></div><div class="suggest-items" id="suggest-items" style="display: none;"></div></div>'),$("div.headerSearch").attr("style","display:block;"),start()}));